<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tag Wiki (update)</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.css"/>
<style>
:root{
  --bg:#0b0c10;--panel:#121318;--text:#e8e8e8;--muted:#a7a7a7;--accent:#71c9f8;
  --fav:#ffd166;--card:#161922;--card2:#1b1f2a;--shadow:0 10px 30px rgba(0,0,0,.35)
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:var(--bg);color:var(--text);
  font:16px/1.55 "Pretendard Variable",Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Apple SD Gothic Neo,sans-serif}
a{color:inherit;text-decoration:none}
header{background:linear-gradient(180deg,var(--bg),rgba(11,12,16,.85));backdrop-filter:saturate(1.2) blur(8px);border-bottom:1px solid #1c1f29;position:relative;z-index:10}
.wrap{max-width:1100px;margin:0 auto;padding:20px}
.title{display:flex;align-items:center;gap:10px}
.title h1{margin:0;font-size:20px;font-weight:800;letter-spacing:.2px}
.desc{margin-top:8px;color:var(--muted);font-size:14px;line-height:1.6}
.fixed-controls{position:sticky;top:0;z-index:15;background:linear-gradient(180deg,var(--bg),rgba(11,12,16,.9));backdrop-filter:blur(8px);padding:16px 20px 10px;border-bottom:1px solid #1c1f29}
.controls{display:grid;gap:10px;grid-template-columns:1fr;grid-template-areas:"q" "sort" "reset" "count"}
.controls .q{grid-area:q}.controls .sort{grid-area:sort}.controls .reset{grid-area:reset}
.controls .count{grid-area:count;justify-self:end;color:var(--muted);font-size:13px}
.controls input,.controls select,.controls button{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2a2f3b;background:var(--panel);color:var(--text)}
.controls input::placeholder{color:var(--muted)}.controls button{cursor:pointer;border-color:#2f3b47}
@media(min-width:900px){.controls{grid-template-columns:1fr 180px 240px auto;grid-template-areas:"q sort reset count"}}
.section-head{display:flex;align-items:center;gap:10px;margin:12px 0 8px}
.badge{font-size:11px;font-weight:700;letter-spacing:.4px;border:1px solid #506086;color:#a9c4ff;background:#12182a;padding:4px 8px;border-radius:6px;text-transform:uppercase}
.sep{height:1px;background:linear-gradient(90deg,#2a3244,transparent);margin:10px 0}
.chips{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:6px}
.chip{border-radius:999px;border:1.5px solid;cursor:pointer;user-select:none;transition:background .15s,border-color .15s,color .15s,transform .05s}
.chip:active{transform:translateY(1px)}.chip:focus-visible{outline:2px solid #88c3ff;outline-offset:3px}
.chip.parent{padding:7px 13px;font-size:14px;font-weight:600;background:#202a42;border-color:#4b5f8f;color:#eaf1ff;box-shadow:0 4px 10px rgba(0,0,0,.3),inset 0 1px 0 rgba(255,255,255,.05)}
.chip.parent:hover{background:#2a3654;border-color:#6f86d6}
.chip.parent.active{background:#5aa8ff;border-color:#82c6ff;color:#0a0e15;font-weight:700;box-shadow:0 0 0 2px rgba(130,198,255,.35),0 8px 16px rgba(0,0,0,.4)}
.chip.facet{padding:7px 12px;font-size:13.5px;font-weight:600;background:#161f31;border-color:#4a566e;color:#e6ecff}
.chip.facet:hover{background:#203152;border-color:#6c82c0}
.chip.facet.active{background:#3e5fa8;border-color:#6f8fd6;color:#fff;box-shadow:0 0 0 2px rgba(111,143,214,.25)}
main{padding:24px 0}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px}
@media(max-width:640px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
.card{position:relative;background:linear-gradient(180deg,var(--card),var(--card2));border:1px solid #22293a;border-radius:14px;overflow:hidden;box-shadow:var(--shadow)}
.card.isFav{border-color:#8a6f2a;box-shadow:0 0 0 2px rgba(255,209,102,.2),var(--shadow)}
.favBtn{position:absolute;left:8px;top:8px;display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;border-radius:999px;border:1px solid #2a2f3b;background:rgba(10,12,18,.75);color:#6b7a8d;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.25)}
.favBtn[aria-pressed="true"]{background:rgba(255,209,102,.2);color:var(--fav);border-color:#8a6f2a;box-shadow:0 0 0 2px rgba(255,209,102,.2),0 6px 16px rgba(0,0,0,.35)}
.thumb{aspect-ratio:1/1;display:block;width:100%;object-fit:cover;background:#0d0f14}
.noThumb{height:10px;background:transparent}
.meta{padding:10px 12px;border-top:1px solid #22293a}
.meta .name{font-size:15px;font-weight:800}
.meta .sub{margin-top:4px;color:var(--muted);font-size:12px}
.badges{display:flex;flex-wrap:wrap;gap:8px;padding:0 12px 10px}
.badge2{background:#202538;border:1px solid #2a2f46;border-radius:999px;padding:6px 10px;font-size:12px;color:#cfd3ff}
.copyBtn{position:absolute;right:8px;bottom:8px;padding:7px 10px;border-radius:10px;border:1px solid #2a2f3b;background:rgba(10,12,18,.75);backdrop-filter:blur(4px);color:#dff2ff;cursor:pointer}
.toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(20px);background:#0f1724;border:1px solid #2a3651;color:#cfe9ff;padding:10px 14px;border-radius:12px;opacity:0;transition:.25s;pointer-events:none}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.empty{color:var(--muted);text-align:center;padding:40px;border:1px dashed #2b3241;border-radius:12px}
#toTop{position:fixed;bottom:28px;right:28px;background:rgba(10,12,18,.8);border:1px solid #2a2f3b;color:var(--accent);border-radius:50%;width:42px;height:42px;display:flex;align-items:center;justify-content:center;cursor:pointer;opacity:0;pointer-events:none;transition:.25s}
#toTop.show{opacity:1;pointer-events:auto;transform:translateY(0)}
#toTop:hover{background:rgba(113,201,248,.15)}
/* crumb 폰트 수정 */
#crumb{font-size:13px;color:#b9c6e8;margin:6px 0 2px;font-weight:500}
#crumb b{color:#eaf1ff;font-weight:600}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="title"><h1>Tag Wiki</h1></div>
    <p class="desc">카테고리/하위 분류 칩으로 필터링. 카드 ‘복사’, ★ 즐겨찾기 유지.</p>
  </div>
</header>

<div class="fixed-controls">
  <div class="wrap">
    <div class="controls">
      <input class="q" id="q" placeholder="검색(표시명/별칭/설명/분류)"/>
      <select class="sort" id="sort">
        <option value="original">등록순</option>
        <option value="newest">최신순</option>
        <option value="titleAsc">제목 A→Z</option>
        <option value="titleDesc">제목 Z→A</option>
        <option value="descLen">설명 짧은 순</option>
      </select>
      <button type="button" class="reset" id="reset">정렬/검색 초기화 (즐겨찾기 유지)</button>
      <div class="count"><span id="count">0</span>개 표시 중</div>
    </div>
    <section id="filter">
      <div class="section-head">
        <span class="badge">카테고리</span>
        <div id="crumb">선택: <b>전체</b></div>
      </div>
      <div class="chips" id="catChips">
        <button type="button" class="chip parent active" data-cat="ALL">전체</button>
        <button type="button" class="chip parent" data-cat="베이스">베이스</button>
        <button type="button" class="chip parent" data-cat="캐릭터">캐릭터</button>
        <button type="button" class="chip parent" data-cat="기본 외형">기본 외형</button>
        <button type="button" class="chip parent" data-cat="세부 외형">세부 외형</button>
        <button type="button" class="chip parent" data-cat="의상">의상</button>
        <button type="button" class="chip parent" data-cat="동작">동작</button>
        <button type="button" class="chip parent" data-cat="상호작용">상호작용</button>
        <button type="button" class="chip parent" data-cat="배경·환경">배경·환경</button>
        <button type="button" class="chip parent" data-cat="소품·효과">소품·효과</button>
      </div>
      <div class="sep"></div>
      <div class="section-head">
        <span class="badge">하위 분류</span>
        <span id="facetHelp" style="font-size:12px;color:#9fb2de">상위 카테고리를 먼저 선택하세요</span>
      </div>
      <div class="chips" id="facetChips"></div>
    </section>
  </div>
</div>

<main class="wrap"><div id="grid" class="grid"></div><div id="empty" class="empty" hidden>검색 결과가 없어요.</div></main>
<button id="toTop" title="맨 위로" type="button">↑</button>
<div id="toast" class="toast"></div>

<script>
/* ========== 예시 데이터 ========== */
var DATA=[{id:'base-001',key:'masterpiece',cat:'베이스',facet:'품질',desc:'고품질 플래그',aliases:['best quality'],copyText:'masterpiece, best quality'}];
var FACETS={
  "베이스":["품질","작화","테마","초점","조명","연출","배경","장소","카메라"],
  "의상":["상의","아우터/정장","하의","원피스","신발","액세서리"]
};
document.addEventListener('DOMContentLoaded',function(){
  function $(s,r){return(r||document).querySelector(s)}
  var g=$('#grid'),empty=$('#empty'),q=$('#q'),sortSel=$('#sort'),resetBtn=$('#reset'),
  countEl=$('#count'),toastEl=$('#toast'),toTop=$('#toTop'),
  catChips=$('#catChips'),facetChips=$('#facetChips'),facetHelp=$('#facetHelp'),crumb=$('#crumb');
  var orderIndex=new Map(DATA.map(function(it,i){return[it.id,i]}));
  var state={cat:'ALL',facets:new Set(),q:'',sort:'original'};
  function makeCard(it){
    var el=document.createElement('article');el.className='card';
    el.innerHTML='<div class="thumb noThumb"></div><button type="button" class="copyBtn" data-clip="'+(it.copyText||it.key)+'">복사</button><div class="meta"><div class="name">'+it.key+'</div><div class="sub">'+it.cat+' · '+it.facet+'</div></div>';
    return el;
  }
  function renderFacetChips(){
    facetChips.innerHTML='';var list=(state.cat==='ALL')?[]:(FACETS[state.cat]||[]);
    if(!list.length){facetHelp.textContent='상위 카테고리를 먼저 선택하세요';return;}
    facetHelp.textContent='다중 선택 가능';
    list.forEach(function(n){var b=document.createElement('button');b.type='button';b.className='chip facet';b.dataset.facet=n;b.textContent=n;if(state.facets.has(n))b.classList.add('active');facetChips.appendChild(b);});
  }
  catChips.addEventListener('click',function(e){
    var b=e.target.closest('button.chip.parent[data-cat]');if(!b)return;
    [].forEach.call(catChips.querySelectorAll('button.chip.parent'),function(x){x.classList.toggle('active',x===b)});
    state.cat=b.dataset.cat;state.facets.clear();crumb.innerHTML='선택: <b>'+state.cat+'</b>';renderFacetChips();render();
  });
  facetChips.addEventListener('click',function(e){
    var b=e.target.closest('button.chip.facet[data-facet]');if(!b)return;b.classList.toggle('active');
    var sel=[].map.call(facetChips.querySelectorAll('.chip.facet.active'),function(x){return x.dataset.facet});
    state.facets=new Set(sel);render();
  });
  function filterByState(list){var arr=list;if(state.cat!=='ALL')arr=arr.filter(function(i){return i.cat===state.cat});if(state.facets.size)arr=arr.filter(function(i){return state.facets.has(i.facet)});return arr;}
  function render(){var list=filterByState(DATA);g.innerHTML='';list.forEach(function(i){g.appendChild(makeCard(i))});empty.hidden=list.length!==0;countEl.textContent=list.length;}
  renderFacetChips();render();
});
</script>
</body>
</html>
