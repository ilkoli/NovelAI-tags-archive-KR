<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Tag Wiki</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.css"/>
<style>
:root{
  --bg:#0b0c10;--panel:#121318;--text:#e8e8e8;--muted:#a7a7a7;--accent:#71c9f8;
  --fav:#ffd166;--card:#161922;--card2:#1b1f2a;--shadow:0 10px 30px rgba(0,0,0,.35)
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:var(--bg);color:var(--text);
  font:16px/1.55 "Pretendard Variable",Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Apple SD Gothic Neo,sans-serif}
header{background:linear-gradient(180deg,var(--bg),rgba(11,12,16,.85));backdrop-filter:saturate(1.2) blur(8px);border-bottom:1px solid #1c1f29}
.wrap{max-width:1100px;margin:0 auto;padding:20px}
.title h1{margin:0;font-size:22px;font-weight:800}
.desc{margin-top:8px;color:var(--muted);font-size:14px}
.fixed-controls{position:sticky;top:0;z-index:15;background:linear-gradient(180deg,var(--bg),rgba(11,12,16,.9));backdrop-filter:blur(8px);padding:16px 20px 10px;border-bottom:1px solid #1c1f29}
.controls{display:grid;gap:10px}
.controls input,.controls select,.controls button{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2a2f3b;background:var(--panel);color:var(--text)}
.controls button{cursor:pointer}
@media(min-width:900px){.controls{grid-template-columns:1fr 180px 240px auto}}
.section-head{display:flex;align-items:center;gap:10px;margin:12px 0 8px}
.badge{font-size:11px;font-weight:700;border:1px solid #506086;color:#a9c4ff;background:#12182a;padding:4px 8px;border-radius:6px;text-transform:uppercase}
.sep{height:1px;background:linear-gradient(90deg,#2a3244,transparent);margin:10px 0}
.chips{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:6px}
.chip{border-radius:999px;border:1.5px solid;cursor:pointer;transition:.15s}
.chip.parent{padding:7px 13px;font-size:14px;background:#202a42;border-color:#4b5f8f;color:#eaf1ff}
.chip.parent.active{background:#5aa8ff;border-color:#82c6ff;color:#0a0e15;font-weight:700}
.chip.facet{padding:7px 12px;font-size:13.5px;background:#161f31;border-color:#4a566e;color:#e6ecff}
.chip.facet.active{background:#3e5fa8;border-color:#6f8fd6;color:#fff}
#crumb{font-size:13px;color:#b9c6e8;margin:6px 0 2px;font-weight:500}
#crumb b{color:#eaf1ff;font-weight:600}
main{padding:24px 0}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px}
.card{position:relative;background:linear-gradient(180deg,var(--card),var(--card2));border:1px solid #22293a;border-radius:14px;overflow:hidden;box-shadow:var(--shadow)}
.card.isFav{border-color:#8a6f2a;box-shadow:0 0 0 2px rgba(255,209,102,.2),var(--shadow)}
.favBtn{position:absolute;left:8px;top:8px;width:30px;height:30px;border-radius:999px;border:1px solid #2a2f3b;background:rgba(10,12,18,.75);color:#6b7a8d;cursor:pointer}
.favBtn[aria-pressed="true"]{background:rgba(255,209,102,.2);color:var(--fav)}
.thumb{aspect-ratio:1/1;display:block;width:100%;object-fit:cover;background:#0d0f14}
.thumb.placeholder{background:linear-gradient(135deg,#151924,#1b2030)}
.copyBtn{position:absolute;right:8px;bottom:8px;padding:7px 10px;border-radius:10px;border:1px solid #2a2f3b;background:rgba(10,12,18,.75);color:#dff2ff;cursor:pointer}
.meta{padding:10px 12px;border-top:1px solid #22293a}
.meta .name{font-size:15px;font-weight:800}
.meta .sub{margin-top:4px;color:var(--muted);font-size:12px}
.toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(20px);background:#0f1724;border:1px solid #2a3651;color:#cfe9ff;padding:10px 14px;border-radius:12px;opacity:0;transition:.25s;pointer-events:none}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
.empty{color:var(--muted);text-align:center;padding:40px;border:1px dashed #2b3241;border-radius:12px}
#toTop{position:fixed;bottom:28px;right:28px;background:rgba(10,12,18,.8);border:1px solid #2a2f3b;color:var(--accent);border-radius:50%;width:42px;height:42px;display:flex;align-items:center;justify-content:center;cursor:pointer;opacity:0;pointer-events:none;transition:.25s}
#toTop.show{opacity:1;pointer-events:auto}
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="title"><h1>Tag Wiki</h1></div>
    <p class="desc">카테고리/하위 분류 필터, 카드 복사/즐겨찾기 가능. 이미지 링크는 외부 호스팅 주소 사용.</p>
  </div>
</header>

<div class="fixed-controls">
  <div class="wrap">
    <div class="controls">
      <input id="q" placeholder="검색(표시명/설명/분류)">
      <select id="sort"><option value="original">등록순</option><option value="titleAsc">제목 A→Z</option><option value="titleDesc">제목 Z→A</option></select>
      <button id="reset">초기화</button><div id="count" style="align-self:center;justify-self:end;color:#aaa;font-size:13px">0개</div>
    </div>
    <div class="section-head"><span class="badge">카테고리</span><div id="crumb">선택: <b>전체</b></div></div>
    <div class="chips" id="catChips">
      <button class="chip parent active" data-cat="ALL">전체</button>
      <button class="chip parent" data-cat="베이스">베이스</button>
      <button class="chip parent" data-cat="의상">의상</button>
      <button class="chip parent" data-cat="동작">동작</button>
    </div>
    <div class="sep"></div>
    <div class="section-head"><span class="badge">하위 분류</span><span id="facetHelp" style="font-size:12px;color:#9fb2de">상위 카테고리 선택</span></div>
    <div class="chips" id="facetChips"></div>
  </div>
</div>

<main class="wrap"><div id="grid" class="grid"></div><div id="empty" class="empty" hidden>없음</div></main>
<div id="toast" class="toast"></div>
<button id="toTop" type="button">↑</button>

<script>
var DATA=[
  {id:'base1',key:'masterpiece',cat:'베이스',facet:'품질',desc:'고품질',copyText:'masterpiece',img:'https://picsum.photos/seed/m1/600'},
  {id:'wear1',key:'one-piece dress',cat:'의상',facet:'원피스',desc:'원피스',copyText:'one-piece dress',img:'https://picsum.photos/seed/op/600'},
  {id:'pose1',key:'looking at viewer',cat:'동작',facet:'시선',desc:'정면 응시',copyText:'looking at viewer',img:'https://picsum.photos/seed/look/600'}
];
var FACETS={
  "베이스":["품질","작화","테마","조명"],
  "의상":["상의","하의","원피스","액세서리"],
  "동작":["표정","시선","포즈"]
};

document.addEventListener('DOMContentLoaded',()=>{
  const $=s=>document.querySelector(s);
  const g=$("#grid"),facetChips=$("#facetChips"),catChips=$("#catChips"),crumb=$("#crumb"),count=$("#count"),toast=$("#toast");
  const state={cat:"ALL",facets:new Set(),q:"",sort:"original"};
  const favs=new Set(JSON.parse(localStorage.getItem("fav")||"[]"));

  function makeCard(it){
    const el=document.createElement("div");
    el.className="card"+(favs.has(it.id)?" isFav":"");
    el.innerHTML=`
      <button class="favBtn" data-id="${it.id}" aria-pressed="${favs.has(it.id)}">★</button>
      <div class="thumbWrap">
        <img class="thumb" src="${it.img||''}" onerror="this.style.display='none';this.insertAdjacentHTML('afterend','<div class=thumb placeholder></div>')" alt="">
        <button class="copyBtn" data-clip="${it.copyText||it.key}">복사</button>
      </div>
      <div class="meta"><div class="name">${it.key}</div><div class="sub">${it.cat} · ${it.facet}</div></div>
      <div class="meta"><div class="sub">${it.desc||''}</div></div>`;
    return el;
  }

  function render(){
    let arr=DATA.filter(i=>(state.cat==="ALL"||i.cat===state.cat));
    if(state.facets.size) arr=arr.filter(i=>state.facets.has(i.facet));
    if(state.q){const q=state.q.toLowerCase();arr=arr.filter(i=>(i.key+i.desc).toLowerCase().includes(q));}
    g.innerHTML="";arr.forEach(i=>g.appendChild(makeCard(i)));count.textContent=arr.length+"개";
    $("#empty").hidden=arr.length>0;
  }

  catChips.onclick=e=>{
    const b=e.target.closest("button[data-cat]");if(!b)return;
    catChips.querySelectorAll("button").forEach(x=>x.classList.toggle("active",x===b));
    state.cat=b.dataset.cat;state.facets.clear();
    crumb.innerHTML="선택: <b>"+state.cat+"</b>";
    facetChips.innerHTML=(FACETS[state.cat]||[]).map(f=>`<button class="chip facet" data-facet="${f}">${f}</button>`).join("");
    render();
  };

  facetChips.onclick=e=>{
    const b=e.target.closest("button[data-facet]");if(!b)return;
    b.classList.toggle("active");
    state.facets=new Set([...facetChips.querySelectorAll(".chip.facet.active")].map(x=>x.dataset.facet));
    render();
  };

  g.onclick=e=>{
    const copy=e.target.closest(".copyBtn");
    const star=e.target.closest(".favBtn");
    if(copy){
      navigator.clipboard.writeText(copy.dataset.clip).then(()=>{toast.textContent="복사됨";toast.classList.add("show");setTimeout(()=>toast.classList.remove("show"),800);});
    }
    if(star){
      const id=star.dataset.id;
      if(favs.has(id))favs.delete(id);else favs.add(id);
      localStorage.setItem("fav",JSON.stringify([...favs]));render();
    }
  };

  $("#q").oninput=e=>{state.q=e.target.value;render();};
  $("#reset").onclick=()=>{$("#q").value="";state.q="";render();};
  render();
});
</script>
</body>
</html>
